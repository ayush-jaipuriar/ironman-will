{
  "info": {
    "name": "Iron Will Core API",
    "description": "Complete API collection for Iron Will Core backend - Authentication, Goals, Audits, Notifications",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_id": "ironwill-core-api-v1"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "goal_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "notification_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Login with Email/Password",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('jwt_token', jsonData.token);",
                  "    pm.test('JWT token received', function() {",
                  "        pm.expect(jsonData.token).to.be.a('string');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"jaipuriar.ayush@gmail.com\",\n  \"password\": \"root\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            },
            "description": "Login with email and password to receive JWT token. Token is automatically saved to collection variable."
          },
          "response": []
        },
        {
          "name": "Get Current User Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('User profile contains required fields', function() {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('email');",
                  "    pm.expect(jsonData).to.have.property('fullName');",
                  "    pm.expect(jsonData).to.have.property('timezone');",
                  "    pm.expect(jsonData).to.have.property('accountabilityScore');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/auth/me",
              "host": ["{{base_url}}"],
              "path": ["auth", "me"]
            },
            "description": "Get currently authenticated user's profile information"
          },
          "response": []
        },
        {
          "name": "Google OAuth Callback (Manual)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/login/oauth2/code/google?code=AUTHORIZATION_CODE&state=STATE",
              "host": ["{{base_url}}"],
              "path": ["login", "oauth2", "code", "google"],
              "query": [
                {
                  "key": "code",
                  "value": "AUTHORIZATION_CODE"
                },
                {
                  "key": "state",
                  "value": "STATE"
                }
              ]
            },
            "description": "OAuth2 callback endpoint (normally handled by browser redirect). Replace AUTHORIZATION_CODE with actual code from Google."
          },
          "response": []
        }
      ],
      "description": "Authentication endpoints for login and profile retrieval"
    },
    {
      "name": "User Management",
      "item": [
        {
          "name": "Update User Timezone",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"timezone\": \"America/New_York\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/timezone",
              "host": ["{{base_url}}"],
              "path": ["api", "user", "timezone"]
            },
            "description": "Update authenticated user's timezone (e.g., America/New_York, Europe/London, Asia/Tokyo)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Goals",
      "item": [
        {
          "name": "Create Goal",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('goal_id', jsonData.id);",
                  "    pm.test('Goal created with ID', function() {",
                  "        pm.expect(jsonData.id).to.be.a('string');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Read 10 pages daily\",\n  \"reviewTime\": \"21:00:00\",\n  \"frequencyType\": \"DAILY\",\n  \"criteriaConfig\": {\n    \"metric\": \"pages\",\n    \"operator\": \">=\",\n    \"target\": 10\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/goals",
              "host": ["{{base_url}}"],
              "path": ["api", "goals"]
            },
            "description": "Create a new accountability goal. Goal ID is automatically saved to collection variable."
          },
          "response": []
        },
        {
          "name": "Get All Goals",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is an array', function() {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/goals",
              "host": ["{{base_url}}"],
              "path": ["api", "goals"]
            },
            "description": "Retrieve all goals for the authenticated user"
          },
          "response": []
        },
        {
          "name": "Get Goal by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Goal has required fields', function() {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.expect(jsonData).to.have.property('title');",
                  "    pm.expect(jsonData).to.have.property('status');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/goals/{{goal_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "goals", "{{goal_id}}"]
            },
            "description": "Retrieve a specific goal by ID (uses goal_id collection variable)"
          },
          "response": []
        },
        {
          "name": "Update Goal",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Read 15 pages daily (UPDATED)\",\n  \"reviewTime\": \"22:00:00\",\n  \"frequencyType\": \"DAILY\",\n  \"criteriaConfig\": {\n    \"metric\": \"pages\",\n    \"operator\": \">=\",\n    \"target\": 15\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/goals/{{goal_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "goals", "{{goal_id}}"]
            },
            "description": "Update an existing goal"
          },
          "response": []
        }
      ],
      "description": "Goal CRUD operations"
    },
    {
      "name": "Audits",
      "item": [
        {
          "name": "Submit Audit Proof (PASS)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Audit verdict received', function() {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('verdict');",
                  "    pm.expect(jsonData).to.have.property('newScore');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "proof",
                  "type": "file",
                  "src": "/path/to/your/proof/image.jpg",
                  "description": "Upload proof image (JPG/PNG, max 5MB)"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/goals/{{goal_id}}/audit",
              "host": ["{{base_url}}"],
              "path": ["api", "goals", "{{goal_id}}", "audit"]
            },
            "description": "Submit proof for goal verification. Select an image file (JPG or PNG) from your computer."
          },
          "response": []
        },
        {
          "name": "Submit Audit Proof (Invalid File Type)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400 (Bad Request)', function() {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "proof",
                  "type": "file",
                  "src": "/path/to/text/file.txt",
                  "description": "Upload non-image file (should fail)"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/goals/{{goal_id}}/audit",
              "host": ["{{base_url}}"],
              "path": ["api", "goals", "{{goal_id}}", "audit"]
            },
            "description": "Test invalid file type rejection (should return 400)"
          },
          "response": []
        },
        {
          "name": "Submit Audit While Locked",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 423 (Locked)', function() {",
                  "    pm.response.to.have.status(423);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "proof",
                  "type": "file",
                  "src": "/path/to/your/proof/image.jpg"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/goals/{{goal_id}}/audit",
              "host": ["{{base_url}}"],
              "path": ["api", "goals", "{{goal_id}}", "audit"]
            },
            "description": "Test audit submission when user is locked out (should return 423)"
          },
          "response": []
        }
      ],
      "description": "Audit submission and verification"
    },
    {
      "name": "Notifications",
      "item": [
        {
          "name": "Get Unread Notifications",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is an array', function() {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.json().length > 0) {",
                  "    pm.collectionVariables.set('notification_id', pm.response.json()[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/unread",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "unread"]
            },
            "description": "Retrieve all unread notifications for the authenticated user"
          },
          "response": []
        },
        {
          "name": "Mark Notification as Read",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/{{notification_id}}/read",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "{{notification_id}}", "read"]
            },
            "description": "Mark a specific notification as read (uses notification_id collection variable)"
          },
          "response": []
        },
        {
          "name": "Mark All Notifications as Read",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwt_token}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/read-all",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "read-all"]
            },
            "description": "Mark all unread notifications as read for the authenticated user"
          },
          "response": []
        }
      ],
      "description": "Notification management"
    },
    {
      "name": "Health Check",
      "item": [
        {
          "name": "Health Check",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function() {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Health check endpoint (no authentication required)"
          },
          "response": []
        }
      ]
    }
  ]
}

